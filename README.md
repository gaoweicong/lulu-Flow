# 一个流程处理,智能问答框架  
> by 高维聪 2019.2.20  

--- --- 

## 概述

单是流程处理, activiti+regular engine足以解决问题, 但要加上数据查询, app跳转, 用户交互, 则前者显得过于臃肿了, 架构在于解决问题, 而不是一味地规范化和扩展功能, 
从用户动机出发, 驱动流程运转的应该是用户的行为和数据, 而用户需要获得的, 也包括消息, 数据, 基于此,编写该架构.

## 模块作用  

+ action: 流程图中控制单元, 最小控制单元根据使用场景分为 决策树, 控制流, 数据流, 对话流,
  流程图整体抽象成事件(Event), 事件的fatherNode是ROOT 事件内部的开始节点和结束节点分别是
  start end 内部有 dataflow dialogflow controlflow decideflow, 
  内部节点的next不能指向外部节点, 但决策树可由外部节点的  
  
+ stateMachine: 状态机, 将用户状态, 数据, 行为抽象成对象,并及时更新.

+ dialog: 返回给用户端的数据对象, 包括对话数据, 控制指令, 图表等.
  
+ controller: 控制引擎, 控制流程走向和状态, 包含触发器和控制器

+ executor: 执行引擎, 执行流程中具体方法, 包括动态代理, 接口调用, 规则引擎等 .

+ loader: 加载引擎, 加载流程关系和执行方法, 加载用户状态机和流程控制单元, 并实时感知变化, 动态更新.

## 扩展

+ 基于spi springboot扩展

+ 扩展控制器, 用户行为驱动(拉模式) 数据驱动(推模式), 接入机器学习, 不再基于流程图规则, 而是基于用户行为习惯.

+ 扩展执行器, 增加接口注册和调用

+ 扩展加载器, 接入NLP语义识别, 感知用户行为, 数据变化.
